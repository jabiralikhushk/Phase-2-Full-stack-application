'use client';\n\nimport { useState, useEffect } from 'react';\nimport { useRouter } from 'next/navigation';\nimport Button from '@/components/ui/Button';\nimport Input from '@/components/ui/Input';\nimport Card from '@/components/ui/Card';\nimport api from '@/lib/api';\n\ninterface Todo {\n  _id: string;\n  title: string;\n  description?: string;\n  completed: boolean;\n  createdAt: string;\n  updatedAt: string;\n}\n\nconst DashboardPage = () => {\n  const [todos, setTodos] = useState<Todo[]>([]);\n  const [newTodo, setNewTodo] = useState({ title: '', description: '' });\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState('');\n  const router = useRouter();\n\n  useEffect(() => {\n    const token = localStorage.getItem('token');\n    if (!token) {\n      router.push('/login');\n      return;\n    }\n    fetchTodos();\n  }, [router]);\n\n  const fetchTodos = async () => {\n    try {\n      const res = await api.get('/api/todos');\n      setTodos(res.data);\n    } catch (err) {\n      setError(err.response?.data?.message || 'Failed to fetch todos');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleInputChange = (e) => {\n    const { name, value } = e.target;\n    setNewTodo(prev => ({ ...prev, [name]: value }));\n  };\n\n  const handleAddTodo = async (e) => {\n    e.preventDefault();\n    if (!newTodo.title.trim()) return;\n\n    try {\n      const res = await api.post('/api/todos', newTodo);\n      setTodos([res.data, ...todos]);\n      setNewTodo({ title: '', description: '' });\n    } catch (err) {\n      setError(err.response?.data?.message || 'Failed to add todo');\n    }\n  };\n\n  const toggleTodo = async (id) => {\n    try {\n      const todo = todos.find(t => t._id === id);\n      if (!todo) return;\n\n      const res = await api.put('/api/todos/' + id, {\n        completed: !todo.completed,\n      });\n\n      setTodos(todos.map(t => (t._id === id ? res.data : t)));\n    } catch (err) {\n      setError(err.response?.data?.message || 'Failed to update todo');\n    }\n  };\n\n  const deleteTodo = async (id) => {\n    if (!window.confirm('Are you sure you want to delete this todo?')) return;\n\n    try {\n      await api.delete('/api/todos/' + id);\n      setTodos(todos.filter(t => t._id !== id));\n    } catch (err) {\n      setError(err.response?.data?.message || 'Failed to delete todo');\n    }\n  };\n\n  const handleLogout = () => {\n    localStorage.removeItem('token');\n    router.push('/login');\n  };\n\n  if (loading) {\n    return (\n      <div className='min-h-screen flex items-center justify-center'>\n        <div className='text-xl'>Loading...</div>\n      </div>\n    );\n  }\n\n  return (\n    <div className='min-h-screen bg-gray-50'>\n      <header className='bg-white shadow'>\n        <div className='max-w-7xl mx-auto px-4 py-6 sm:px-6 lg:px-8 flex justify-between items-center'>\n          <h1 className='text-3xl font-bold text-gray-900'>My Bonsai App</h1>\n          <Button variant='secondary' onClick={handleLogout}>\n            Logout\n          </Button>\n        </div>\n      </header>\n      <main className='max-w-7xl mx-auto px-4 py-6 sm:px-6 lg:px-8'>\n        {error && (\n          <div className='bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4' role='alert'>\n            <span className='block sm:inline'>{error}</span>\n          </div>\n        )}\n        <Card className='mb-8'>\n          <h2 className='text-xl font-semibold mb-4'>Add New Todo</h2>\n          <form onSubmit={handleAddTodo} className='space-y-4'>\n            <Input\n              label='Title'\n              id='title'\n              name='title'\n              type='text'\n              placeholder='What needs to be done?'\n              value={newTodo.title}\n              onChange={handleInputChange}\n              required\n            />\n            <div className='mb-4'>\n              <label htmlFor='description' className='block text-sm font-medium text-gray-700 mb-1'>\n                Description\n              </label>\n              <textarea\n                id='description'\n                name='description'\n                placeholder='Add details...'\n                value={newTodo.description}\n                onChange={handleInputChange}\n                className='w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500'\n              />\n            </div>\n            <Button type='submit' variant='primary'>\n              Add Todo\n            </Button>\n          </form>\n        </Card>\n        <div>\n          <h2 className='text-xl font-semibold mb-4'>Your Todos ({todos.length})</h2>\n          {todos.length === 0 ? (\n            <p className='text-gray-500'>No todos yet. Add one above!</p>\n          ) : (\n            <div className='grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4'>\n              {todos.map(todo => (\n                <Card key={todo._id} className={todo.completed ? 'bg-green-50' : ''}>\n                  <div className='flex justify-between items-start'>\n                    <div>\n                      <h3 className={'font-medium ' + (todo.completed ? 'line-through text-gray-500' : 'text-gray-900')}>\n                        {todo.title}\n                      </h3>\n                      {todo.description && (\n                        <p className={'mt-1 text-sm ' + (todo.completed ? 'line-through text-gray-500' : 'text-gray-600')}>\n                          {todo.description}\n                        </p>\n                      )}\n                      <p className='mt-2 text-xs text-gray-500'>\n                        Created: {new Date(todo.createdAt).toLocaleDateString()}\n                      </p>\n                    </div>\n                    <div className='flex space-x-2'>\n                      <Button\n                        variant={todo.completed ? 'secondary' : 'primary'}\n                        onClick={() => toggleTodo(todo._id)}\n                        className='text-xs'\n                      >\n                        {todo.completed ? 'Undo' : 'Complete'}\n                      </Button>\n                      <Button\n                        variant='danger'\n                        onClick={() => deleteTodo(todo._id)}\n                        className='text-xs'\n                      >\n                        Delete\n                      </Button>\n                    </div>\n                  </div>\n                </Card>\n              ))}\n            </div>\n          )}\n        </div>\n      </main>\n    </div>\n  );\n};\n\nexport default DashboardPage;