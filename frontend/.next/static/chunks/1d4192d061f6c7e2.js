(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,69370,(e,t,a)=>{t.exports=e.r(4725)},57235,e=>{"use strict";var t=e.i(67280),a=e.i(464),s=e.i(69370);let r=e.i(89814).default.env.NEXT_PUBLIC_API_URL||"http://localhost:8000/api",o=()=>{let e={"Content-Type":"application/json"},t=localStorage.getItem("auth_token");return t&&(e.Authorization=`Bearer ${t}`),e},i=async e=>{if(401===e.status)throw localStorage.removeItem("auth_token"),localStorage.removeItem("user_id"),window.location.href="/auth",Error("Unauthorized: Please log in again");if(403===e.status)throw Error("Access forbidden: You do not have permission to perform this action");if(422===e.status){let t=await e.json();throw Error(`Validation error: ${t.detail||"Invalid input"}`)}if(!e.ok)throw Error((await e.json().catch(()=>({}))).detail||`API error: ${e.status} ${e.statusText}`)},n=async e=>{let t=await fetch(`${r}/${e}/tasks`,{method:"GET",headers:o()});return await i(t),t.json()},l=async(e,t)=>{let a=await fetch(`${r}/${e}/tasks`,{method:"POST",headers:o(),body:JSON.stringify(t)});return await i(a),a.json()},d=async(e,t,a)=>{let s=await fetch(`${r}/${e}/tasks/${t}`,{method:"PUT",headers:o(),body:JSON.stringify(a)});return await i(s),s.json()},c=async(e,t)=>{let a=await fetch(`${r}/${e}/tasks/${t}`,{method:"DELETE",headers:o()});await i(a)},u=async(e,t)=>{let a=await fetch(`${r}/${e}/tasks/${t}/complete`,{method:"PATCH",headers:o()});return await i(a),a.json()},m=({task:e,onUpdate:s,onDelete:r,onToggleCompletion:o})=>{let[i,n]=(0,a.useState)(!1),[l,d]=(0,a.useState)(e.title),[c,u]=(0,a.useState)(e.description||""),[m,g]=(0,a.useState)(!1),x=async()=>{g(!0);try{await s(e.id,{title:l,description:c||void 0}),n(!1)}finally{g(!1)}},h=async()=>{g(!0);try{await o(e.id)}finally{g(!1)}},f=async()=>{if(window.confirm(`Are you sure you want to delete "${e.title}"?`)){g(!0);try{await r(e.id)}finally{g(!1)}}};return(0,t.jsxs)("li",{className:"px-4 py-4 sm:px-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("input",{type:"checkbox",checked:e.completed,onChange:h,disabled:m,className:`w-4 h-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500 ${m?"opacity-50":""}`}),i?(0,t.jsxs)("div",{className:"ml-3 flex-1",children:[(0,t.jsx)("input",{type:"text",value:l,onChange:e=>d(e.target.value),disabled:m,className:`block w-full px-3 py-2 text-base text-gray-900 placeholder-gray-500 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 ${m?"bg-gray-100":""}`}),(0,t.jsx)("textarea",{value:c,onChange:e=>u(e.target.value),disabled:m,className:`block w-full px-3 py-2 mt-2 text-base text-gray-900 placeholder-gray-500 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 ${m?"bg-gray-100":""}`,rows:2})]}):(0,t.jsxs)("div",{className:"ml-3 flex-1",children:[(0,t.jsx)("p",{className:`text-sm font-medium ${e.completed?"line-through text-gray-500":"text-gray-900"}`,children:e.title}),e.description&&(0,t.jsx)("p",{className:`mt-1 text-sm ${e.completed?"text-gray-400":"text-gray-500"}`,children:e.description})]})]}),(0,t.jsx)("div",{className:"flex space-x-2",children:i?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{onClick:x,disabled:m,className:`inline-flex items-center px-2.5 py-1.5 border border-transparent text-xs font-medium rounded text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 ${m?"opacity-50 cursor-not-allowed":""}`,children:m?"Saving...":"Save"}),(0,t.jsx)("button",{onClick:()=>{d(e.title),u(e.description||""),n(!1)},disabled:m,className:`inline-flex items-center px-2.5 py-1.5 border border-gray-300 text-xs font-medium rounded text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 ${m?"opacity-50 cursor-not-allowed":""}`,children:"Cancel"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{onClick:()=>n(!0),disabled:m,className:`inline-flex items-center px-2.5 py-1.5 border border-gray-300 text-xs font-medium rounded text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 ${m?"opacity-50 cursor-not-allowed":""}`,children:"Edit"}),(0,t.jsx)("button",{onClick:f,disabled:m,className:`inline-flex items-center px-2.5 py-1.5 border border-transparent text-xs font-medium rounded text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 ${m?"opacity-50 cursor-not-allowed":""}`,children:m?"Deleting...":"Delete"})]})})]}),(0,t.jsxs)("div",{className:"mt-2 text-xs text-gray-500",children:[(0,t.jsxs)("span",{children:["Created: ",new Date(e.created_at).toLocaleString()]}),(0,t.jsxs)("span",{className:"ml-2",children:["Updated: ",new Date(e.updated_at).toLocaleString()]})]})]})},g=({tasks:e,onUpdateTask:a,onDeleteTask:s,onToggleCompletion:r})=>0===e.length?(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"No tasks"}),(0,t.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Get started by creating a new task."})]}):(0,t.jsx)("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:(0,t.jsx)("ul",{className:"divide-y divide-gray-200",children:e.map(e=>(0,t.jsx)(m,{task:e,onUpdate:a,onDelete:s,onToggleCompletion:r},e.id))})}),x=({onCreateTask:e})=>{let[s,r]=(0,a.useState)(""),[o,i]=(0,a.useState)(""),[n,l]=(0,a.useState)(!1),[d,c]=(0,a.useState)(null),u=async t=>{if(t.preventDefault(),!s.trim())return void c("Title is required");l(!0),c(null);try{await e(s,o||void 0),r(""),i("")}catch(e){c("Failed to create task. Please try again."),console.error("Error creating task:",e)}finally{l(!1)}};return(0,t.jsx)("div",{className:"bg-white shadow sm:rounded-lg",children:(0,t.jsxs)("div",{className:"px-4 py-5 sm:p-6",children:[(0,t.jsx)("h3",{className:"text-lg font-medium leading-6 text-gray-900",children:"Create New Task"}),d&&(0,t.jsx)("div",{className:"p-3 mt-4 text-red-700 bg-red-100 rounded-md",children:d}),(0,t.jsxs)("form",{onSubmit:u,className:"mt-4 space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700",children:"Title"}),(0,t.jsx)("input",{type:"text",id:"title",value:s,onChange:e=>r(e.target.value),disabled:n,className:`block w-full px-3 py-2 mt-1 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 ${n?"bg-gray-100":""}`,placeholder:"What needs to be done?"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700",children:"Description (optional)"}),(0,t.jsx)("textarea",{id:"description",value:o,onChange:e=>i(e.target.value),disabled:n,rows:3,className:`block w-full px-3 py-2 mt-1 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 ${n?"bg-gray-100":""}`,placeholder:"Add details..."})]}),(0,t.jsx)("div",{className:"flex justify-end",children:(0,t.jsx)("button",{type:"submit",disabled:n,className:`inline-flex items-center px-4 py-2 text-sm font-medium text-white bg-indigo-600 border border-transparent rounded-md shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 ${n?"opacity-50 cursor-not-allowed":""}`,children:n?"Adding Task...":"Add Task"})})]})]})})};function h(){let[e,r]=(0,a.useState)([]),[o,i]=(0,a.useState)(!0),[m,h]=(0,a.useState)(null),f=(0,s.useRouter)(),y=localStorage.getItem("user_id")||"default_user_id";(0,a.useEffect)(()=>{localStorage.getItem("auth_token")?p():f.push("/auth")},[f]);let p=async()=>{try{i(!0);let e=await n(y);r(e),h(null)}catch(e){console.error("Error fetching tasks:",e),h("Failed to load tasks. Please try again later.")}finally{i(!1)}},b=async(t,a)=>{try{let s=await l(y,{title:t,description:a});r([...e,s])}catch(e){console.error("Error creating task:",e),h("Failed to create task. Please try again.")}},w=async(t,a)=>{try{let s=await d(y,t,a);r(e.map(e=>e.id===t?s:e))}catch(e){console.error("Error updating task:",e),h("Failed to update task. Please try again.")}},j=async t=>{try{await c(y,t),r(e.filter(e=>e.id!==t))}catch(e){console.error("Error deleting task:",e),h("Failed to delete task. Please try again.")}},v=async t=>{try{let a=await u(y,t);r(e.map(e=>e.id===t?a:e))}catch(e){console.error("Error toggling task completion:",e),h("Failed to update task. Please try again.")}};return o?(0,t.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"Loading Dashboard..."}),(0,t.jsx)("p",{className:"text-gray-600",children:"Fetching your tasks"})]})}):(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,t.jsx)("header",{className:"bg-white shadow",children:(0,t.jsx)("div",{className:"px-4 py-6 mx-auto max-w-7xl sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"My Tasks"}),(0,t.jsx)("button",{onClick:()=>{localStorage.removeItem("auth_token"),localStorage.removeItem("user_id"),f.push("/auth")},className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:"Logout"})]})})}),(0,t.jsx)("main",{className:"py-8",children:(0,t.jsxs)("div",{className:"px-4 mx-auto max-w-7xl sm:px-6 lg:px-8",children:[m&&(0,t.jsx)("div",{className:"p-4 mb-6 text-red-700 bg-red-100 rounded-md",children:m}),(0,t.jsx)(x,{onCreateTask:b}),(0,t.jsx)("div",{className:"mt-8",children:(0,t.jsx)(g,{tasks:e,onUpdateTask:w,onDeleteTask:j,onToggleCompletion:v})})]})})]})}e.s(["default",()=>h],57235)}]);